- id: 'telegramboot'
  alias: 'Telegram bot to notify on boot'
  initial_state: false
  trigger:
  - event: start
    platform: homeassistant
  condition: []
  action:
  - service: notify.telegram_sarah
    data:
      message: Home Assistant booted!
- id: 'telegramremoveinline'
  alias: 'Telegram callback to remove keyboard'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/removekeyboard'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
- id: 'telegramemptywasher'
  alias: 'Telegram callback to change washer to Idle'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/empty_washer'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK, changing washer to Idle'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
  - service: mqtt.publish
    data:
      topic: hass/state/washer
      payload: 'Idle'
      retain: 'true'
- id: 'telegramrepeat30m'
  alias: 'Telegram callback to repeat message in 30 minutes'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/30m'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK, reminding you in 30 minutes'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
  - delay: '00:30:00'
  - service: notify.telegram_sarah
    data_template:
      message: '{{ trigger.event.data.message.text }}'
      data:
        inline_keyboard:
          - '30 Minutes:/30m, 1 Hour:/1h, already empty:/empty_washer'
          - 'No reminder:/removekeyboard'
- id: 'telegramrepeat1h'
  alias: 'Telegram callback to repeat message in 1 hour'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/1h'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK, reminding you in 1 hour'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
  - delay: '01:00:00'
  - service: notify.telegram_sarah
    data_template:
      message: '{{ trigger.event.data.message.text }}'
      data:
        inline_keyboard:
          - '30 Minutes:/30m, 1 Hour:/1h, already empty:/empty_washer'
          - 'No reminder:/removekeyboard'
- id: 'telegramemptydryer'
  alias: 'Telegram callback to change dryer to Idle'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/empty_dryer'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK, changing dryer to Idle'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
  - service: mqtt.publish
    data:
      topic: hass/state/dryer
      payload: 'Idle'
      retain: 'true'
- id: 'telegramrepeat30mdryer'
  alias: 'Telegram callback to repeat message in 30 minutes - dryer'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/30mdryer'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK, reminding you in 30 minutes'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
  - delay: '00:30:00'
  - service: notify.telegram_sarah
    data_template:
      message: '{{ trigger.event.data.message.text }}'
      data:
        inline_keyboard:
          - '30 Minutes:/30mdryer, 1 Hour:/1hdryer, already empty:/empty_dryer'
          - 'No reminder:/removekeyboard'
- id: 'telegramrepeat1hdryer'
  alias: 'Telegram callback to repeat message in 1 hour - dryer'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      data: '/1hdryer'
  action:
  - service: telegram_bot.answer_callback_query
    data_template:
      callback_query_id: '{{ trigger.event.data.id }}'
      message: 'OK, reminding you in 1 hour'
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.user_id }}'
      inline_keyboard: []
  - delay: '01:00:00'
  - service: notify.telegram_sarah
    data_template:
      message: '{{ trigger.event.data.message.text }}'
      data:
        inline_keyboard:
          - '30 Minutes:/30mdryer, 1 Hour:/1hdryer, already empty:/empty_dryer'
          - 'No reminder:/removekeyboard'